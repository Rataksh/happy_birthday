<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script src="https://kit.fontawesome.com/a14ae32021.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Happy Birthday Bianca!</title>

    <style type="text/css">
        @font-face {
            font-family: digit;
            src: url('digital-7_mono.ttf') format("truetype");
        }

        #icon {
            cursor: pointer;
            font-size: 3em;
            color: red;
            transition: transform 0.3s ease-in-out;
        }

        #icon:hover {
            transform: scale(1.2);
        }

        #loveHeart {
            width: 100%;
            text-align: center;
            margin-top: 15px;
            position: relative;
        }

        canvas {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

		#words{font-family:"sans-serif";width:500px;font-size:24px;color:#666}
		#timer {
            text-align:center;font-size:25px;margin-top:10px;margin-bottom:10px
        }

		#startBtn{font-size: 48px;color: red;margin: 50 px; align-content: center;}
		#msg{margin-bottom:25px}
		#timer .digit{font-family:"digit";font-size:30px;text-align: center;}
		</style>

    <link href="css/default.css" type="text/css" rel="stylesheet">
</head>

<body>

    <div id="mainDiv">
        <div id="content">
            <div id="code">
                Hellyo,<br />
				I don't know how to do this, so bear with me <br>
				<br>
				<br>
				On this special occassion of your birthday<br>
				(will be easier to remember lol) - ab kalesh mat kario ispe, <br>
				I would like to complete this long overdue task of PROPOSING YOU <br>
				I think it's high time we made it official, right?<br>
				<br>
				Anyway, thank you Bhumica for coming in my life so unexpectedly and making it better <br>
				From Rockstar to Kal ho na ho, we came a long way(wish the film was longer too)<br>
				and we have a long way to go too<br>
				<br>
				So, to fire the starting gun for this long journey, <br>
				what you have here is a full blown official proposal <br>
				which you can accept(you don't really have another choice lol) by clicking this red heart on your right<br>
				and start this timer so you can look at it later and remember the time when you made your best decision(haha)<br>
                <br>
				Oh! Also, Happy Birthday to you! Send me a picture in that red dress(;
                
            </div>
            <div id="loveHeart">
                <canvas id="garden"></canvas>
                <div id="words">
                    <div id="messages">
						<div id="msg">
                        Do you accept my proposal?
						
						</div>
						<i class="fas fa-heart" id="startBtn">
							YES!
						</i>
                        <div id="timer">0 <span class="digit">days</span> 00<span class="digit"> hours</span><br> 00 <span class="digit">minutes</span> 00 <span class="digit">seconds</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="js/garden.js"></script>
    <script type="text/javascript" src="js/functions.js"></script>

    <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", function() {
            console.log("✅ DOM is fully loaded!");

            // Define offsetX and offsetY for heart animation
            window.offsetX = $("#loveHeart").width() / 2;
            window.offsetY = $("#loveHeart").height() / 2 - 55;

            let heart = document.getElementById("icon");

            if (heart) {
                console.log("✅ Heart element found!");
                heart.addEventListener("click", function() {
                    console.log("❤️ Heart clicked! Timer should start now.");
                    startTimerFromZero();
                });
            } else {
                console.error("❌ ERROR: Heart element (#icon) not found!");
            }

            // 🔥 Start Heart Animation
            if (typeof startHeartAnimation === "function") {
                setTimeout(startHeartAnimation, 3000);
                console.log("💖 Heart animation started!");
            } else {
                console.error("❌ ERROR: startHeartAnimation function not found!");
            }

            // 🔥 Start Typewriter Effect
            if ($("#code").length > 0 && typeof $("#code").typewriter === "function") {
                $("#code").typewriter();
                console.log("✍️ Typewriter effect applied!");
            } else {
                console.error("❌ ERROR: Typewriter effect not found!");
            }
        });

		let timerInterval; 

function startTimer() {
    let storedStartTime = localStorage.getItem("timerStartTime");

    if (!storedStartTime) {
        // Save current time only if there's no existing start time
        localStorage.setItem("timerStartTime", new Date().getTime());
    }

    console.log("⏳ Timer started or resumed at:", localStorage.getItem("timerStartTime"));

    updateTimer(); // Update immediately
    timerInterval = setInterval(updateTimer, 1000); // Start interval
}

function updateTimer() {
    let storedStartTime = localStorage.getItem("timerStartTime");

    if (!storedStartTime) return; // If no timer found, exit

    let startTime = parseInt(storedStartTime);
    let currentTime = new Date().getTime();
    let elapsedTime = Math.floor((currentTime - startTime) / 1000);

    let days = Math.floor(elapsedTime / 86400);
    let hours = Math.floor((elapsedTime % 86400) / 3600);
    let minutes = Math.floor((elapsedTime % 3600) / 60);
    let seconds = elapsedTime % 60;

    let formattedTime = `
        <span>${days}</span> <span class="digit">days</span> 
        <span>${hours.toString().padStart(2, "0")}</span> <span class="digit">hours</span> <br>
        <span>${minutes.toString().padStart(2, "0")}</span> <span class="digit">minutes</span> 
        <span>${seconds.toString().padStart(2, "0")}</span> <span class="digit">seconds</span>
    `;

    document.getElementById("timer").innerHTML = formattedTime;
}

// Check if a timer was already started when the page loads
document.addEventListener("DOMContentLoaded", function() {
    if (localStorage.getItem("timerStartTime")) {
        startTimer(); // Resume timer if start time exists
    }
});

document.getElementById("startBtn").addEventListener("click", startTimer);


    </script>

</body>
</html>
